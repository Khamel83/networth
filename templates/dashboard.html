{% extends "base.html" %}
{% block title %}Dashboard - NET WORTH{% endblock %}
{% block content %}
<h1 style="margin-bottom: 2rem;">Welcome, {{ player.name }}!</h1>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
    <div class="card" style="background: var(--gradient); color: white;">
        <h3>Rank</h3>
        <p style="font-size: 2.5rem; font-weight: 700;">#{{ rank }}</p>
        <p style="opacity: 0.9;">of {{ total_players}} players</p>
    </div>
    <div class="card">
        <h3>Record</h3>
        <p style="font-size: 2rem; font-weight: 700;">{{ player.wins }}-{{ player.losses }}</p>
        <p>Win Rate: {{ "%.1f"|format(win_rate) }}%</p>
    </div>
    <div class="card">
        <h3>Score</h3>
        <p style="font-size: 2rem; font-weight: 700;">{{ player.total_score }}</p>
        <p>Skill: {{ player.skill_level }}</p>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
    <div class="card">
        <h2>Recent Matches</h2>
        {% if recent_matches %}
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Opponent</th>
                    <th>Score</th>
                </tr>
            </thead>
            <tbody>
                {% for match in recent_matches %}
                <tr>
                    <td>{{ match.match_date }}</td>
                    <td>{% if match.player1_id == session.player_id %}{{ match.player2_name }}{% else %}{{ match.player1_name }}{% endif %}</td>
                    <td>{{ match.player1_set1 }}-{{ match.player2_set1 }}, {{ match.player1_set2 }}-{{ match.player2_set2 }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>No matches yet.</p>
        {% endif %}
    </div>

    <div class="card">
        <h2>Quick Actions</h2>
        <div style="display: flex; flex-direction: column; gap: 1rem;">
            <a href="/report-score" class="btn btn-primary"><i class="fas fa-plus"></i> Report Score</a>
            <a href="/history" class="btn btn-secondary"><i class="fas fa-history"></i> View Full History</a>
        </div>
        {% if pending_matches %}
        <h3 style="margin-top: 2rem;">Pending Scores ({{ pending_matches|length }})</h3>
        <p style="color: var(--warning);">You have {{ pending_matches|length }} match(es) awaiting admin review.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
