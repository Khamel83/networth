# Mid-Month Reminder
# Runs on 15th of each month at 9am PT (5pm UTC)
# Reminds players who haven't reported their match yet

name: Mid-Month Reminder

on:
  schedule:
    # 15th of month at 9am PT (5pm UTC)
    - cron: '0 17 15 * *'
  workflow_dispatch:  # Allow manual trigger

jobs:
  send-reminders:
    runs-on: ubuntu-latest

    steps:
      - name: Check if enabled
        run: |
          echo "⚠️ EMAIL_ENABLED must be 'true' in Vercel env vars for emails to send"
          echo "Sending reminders for matches not yet reported"

      - name: Send reminder emails
        run: |
          curl -X POST "${{ secrets.SITE_URL }}/api/email" \
            -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
            -H "Content-Type: application/json" \
            -d '{"action": "send_reminders"}'

      - name: Log result
        run: echo "Mid-month reminders job completed"
