# End-of-Month Last Chance Reminder
# Runs on 28th of each month at 9am PT (5pm UTC)
# Sends "last chance" reminders to players who haven't reported yet

name: End-of-Month Reminder

on:
  schedule:
    # 28th of month at 9am PT (5pm UTC)
    - cron: '0 17 28 * *'
  workflow_dispatch:  # Allow manual trigger

jobs:
  send-last-chance:
    runs-on: ubuntu-latest

    steps:
      - name: Check if enabled
        run: |
          echo "Sending last chance reminders for matches not yet reported"

      - name: Send last chance emails
        run: |
          curl -X POST "${{ secrets.SITE_URL }}/api/email" \
            -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
            -H "Content-Type: application/json" \
            -d '{"action": "send_last_chance"}'

      - name: Log result
        run: echo "End-of-month reminders job completed"
